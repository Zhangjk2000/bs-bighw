{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-1383beca\"],{b270:function(t,i,e){\"use strict\";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e(\"el-row\",{attrs:{gutter:3}},[e(\"el-col\",{attrs:{span:2}},[e(\"div\",{staticClass:\"pics\"},[e(\"div\",{staticClass:\"arrow arrow-left\",on:{click:function(i){return t.showMore(\"down\")}}}),e(\"div\",{staticClass:\"pic-container\"},[e(\"div\",{ref:\"picContainer\",staticClass:\"pic-box\"},t._l(t.imgList,(function(i,a){return e(\"div\",{key:a,staticClass:\"pic\"},[e(\"div\",{staticClass:\"info\",style:{\"background-image\":\"url(\"+i+\")\"},on:{click:function(e){return t.activePic(i)}}})])})),0)]),e(\"div\",{staticClass:\"arrow arrow-right\",on:{click:function(i){return t.showMore(\"up\")}}})])]),e(\"el-col\",{attrs:{span:16}},[e(\"el-form\",{ref:\"currentInfo\",attrs:{id:\"el-form\",\"label-position\":\"left\",\"label-width\":\"30px\"}},[e(\"el-row\",{staticStyle:{width:\"100%\",height:\"90%\"}},[e(\"el-form-item\",[e(\"h3\",{staticClass:\"image_title\"},[t._v(\" 标注图片 （\"+t._s(t.currentInfo.currentBaseImage.name)+\"）\")]),e(\"div\",{ref:\"imageWrapper\",staticClass:\"signBox\"},[e(\"div\",{staticClass:\"sign-main\"},[e(\"ui-marker\",{ref:\"aiPanel-editor\",staticClass:\"ai-observer\",attrs:{uniqueKey:t.uuid,ratio:16/9,imgUrl:t.currentInfo.currentBaseImage},on:{\"vmarker:onImageLoad\":t.onImageLoad}})],1)])])],1)],1)],1),e(\"el-col\",{attrs:{span:4}},[e(\"div\",{staticStyle:{width:\"100%\",height:\"300px\"}}),e(\"div\",{staticClass:\"title\"},[t._v(\"标签\")]),t._l(t.tags,(function(i,a){return e(\"div\",{key:a,staticClass:\"tags\"},[e(\"el-tag\",{attrs:{size:\"small\"},on:{click:function(e){return t.setTag(i)}}},[t._v(\" \"+t._s(i.tagName)+\" \")]),e(\"i\",{staticClass:\"el-icon-delete\",on:{click:function(i){return t.delTag(a)}}})],1)})),e(\"el-row\",[e(\"el-button\",{staticClass:\"handleButton\",attrs:{type:\"success\"},on:{click:t.addTag}},[t._v(\" 添加标签 \")])],1),e(\"el-row\",[e(\"el-button\",{staticClass:\"handleButton\",attrs:{type:\"primary\"},on:{click:function(i){return t.submitForm(\"xml\")}}},[t._v(\" 导出为XML \")])],1),e(\"el-row\",[e(\"el-button\",{staticClass:\"handleButton\",attrs:{type:\"primary\"},on:{click:function(i){return t.submitForm(\"createML\")}}},[t._v(\" 导出为createML \")])],1)],2)],1)},s=[],n=e(\"5530\"),r=(e(\"a434\"),e(\"ac1f\"),e(\"1276\"),e(\"d3b7\"),e(\"25f0\"),e(\"b680\"),e(\"a253\")),o=e(\"278e\"),l=e(\"2f62\"),c={name:\"stagePicPage\",components:{\"ui-marker\":r[\"AIMarker\"]},data:function(){return{formInline:{region:\"\",radio:\"全部\"},dataList:[],imgList:[],uuid:\"0da9130\",currentInfo:{currentBaseImage:\"\",rawW:0,rawH:0,currentW:0,currentH:0,checked:!1,data:[]},active:0,picTotal:10,tags:[{tagName:\"cat\",tag:\"0x0001\"},{tagName:\"dog\",tag:\"0x0002\"}],allInfo:[],imageInfo:[],innerVisible:!1,innerForm:{tagName:\"\",tag:\"\"},tep_rules:{tagName:[{required:!0,message:\"请输入\",trigger:\"blur\"}],tag:[{required:!0,message:\"请输入\",trigger:\"blur\"}]}}},computed:Object(n[\"a\"])(Object(n[\"a\"])({},Object(l[\"b\"])([\"receivetaskList\"])),Object(l[\"b\"])([\"labels\"])),mounted:function(){this.dataList=this.receivetaskList},methods:{onImageLoad:function(t){console.log(\"data:\"),console.log(t),this.imageInfo=t},getImgList:function(t){var i=this;Object(o[\"g\"])(t).then((function(t){i.imgList=t.data[\"img_list\"]}))},setTag:function(t){this.$refs[\"aiPanel-editor\"].getMarker().setTag(t)},addTag:function(){this.innerVisible=!0,this.innerForm.tagName=\"\",this.innerForm.tag=\"\"},delTag:function(t){this.tags.splice(t,1)},close:function(){this.innerVisible=!1,this.$refs[\"innerForm\"].resetFields()},beforeClose:function(t){this.$refs[\"innerForm\"].resetFields(),t()},createForm:function(t){var i=this;this.$refs[t].validate((function(t){if(t){for(var e in i.tags){var a=i.tags[e];if(a.tagName===i.innerForm.tagName||a.tag===i.innerForm.tag)return void i.$message.warning(\"标签名或标签值已存在，请重新输入\")}i.tags.push({tagName:i.innerForm.tagName,tag:i.innerForm.tag}),i.innerVisible=!1}}))},submitForm:function(t){var i=this.$refs[\"aiPanel-editor\"].getMarker().getData(),e={filename:\"\",height:0,width:0,xmin:[],xmax:[],ymin:[],ymax:[],tag:[]};this.allInfo=i,console.log(this.allInfo);var a={width:this.imageInfo.rawW,height:this.imageInfo.rawH};console.log(this.currentInfo.currentBaseImage),e.filename=this.currentInfo.currentBaseImage[0].split(\"/\").pop().split(\".\")[0],e.width=a.width,e.height=a.height;for(var s=0;s<this.allInfo.length;s++){var n=(parseInt(this.allInfo[0].position.x.substring(0,this.allInfo[0].position.x.length-1))*a.width/100).toFixed(0).toString();console.log(n,\"左上\");var r=(parseInt(this.allInfo[0].position.y.substring(0,this.allInfo[0].position.y.length-1))*a.height/100).toFixed(0).toString();console.log(r,\"右上\");var o=(parseInt(this.allInfo[0].position.x1.substring(0,this.allInfo[0].position.x1.length-1))*a.width/100).toFixed(0).toString();console.log(o,\"右上\");var l=(parseInt(this.allInfo[0].position.y1.substring(0,this.allInfo[0].position.y1.length-1))*a.height/100).toFixed(0).toString();console.log(l,\"左上\");var c=this.allInfo[s].tagName;e.xmin.push(n),e.xmax.push(o),e.ymin.push(r),e.ymax.push(l),e.tag.push(c)}console.log(\"Labels:\"),console.log(e),this.$store.dispatch(\"annotate/setLabels\",{Labels:e,form:t}),this.$message.success(\"标签保存成功\")},showMore:function(t){var i=this.$refs.picContainer;if(\"up\"==t){if(this.active++,this.active>=this.picTotal-3)return void(this.active=this.pics.length-3);if(this.pics.length-3==this.active&&this.pics.length<this.picTotal)return this.photoPageIndex++,void this.getPhotos()}else this.active--,this.active<0&&(this.active=0);i.style.transform=\"translateX(-\"+this.active/this.pics.length*100+\"%)\"},getPhotos:function(){var t=this;return this.$nextTick((function(){var i=t.$refs.picContainer;i&&(i.style.width=i.scrollWidth+\"px\",i.style.transform=\"translateX(-\"+t.active/t.pics.length*100+\"%)\")}))},activePic:function(t){this.currentInfo.currentBaseImage=t},handleChange:function(t){console.log(t)}}},g=c,h=(e(\"d9f4\"),e(\"2877\")),u=Object(h[\"a\"])(g,a,s,!1,null,\"9a6228be\",null);i[\"default\"]=u.exports},d9f4:function(t,i,e){\"use strict\";e(\"df51\")},df51:function(t,i,e){}}]);","extractedComments":[]}