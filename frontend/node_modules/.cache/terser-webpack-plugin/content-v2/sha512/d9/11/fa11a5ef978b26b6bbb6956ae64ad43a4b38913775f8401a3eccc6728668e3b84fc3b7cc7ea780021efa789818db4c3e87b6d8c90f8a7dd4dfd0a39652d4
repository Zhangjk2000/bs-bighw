{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-07356c76\"],{\"063b\":function(t,e,n){\"use strict\";n(\"85e2\")},\"0a6c\":function(t,e,n){},\"195f\":function(t,e,n){},\"21c1\":function(t,e,n){},\"36ed\":function(t,e,n){\"use strict\";n(\"0a6c\")},8083:function(t,e,n){\"use strict\";n(\"195f\")},8110:function(t,e,n){\"use strict\";n(\"93f5\")},\"84f5\":function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return a})),n.d(e,\"c\",(function(){return i})),n.d(e,\"f\",(function(){return s})),n.d(e,\"e\",(function(){return r})),n.d(e,\"b\",(function(){return l})),n.d(e,\"d\",(function(){return c}));var o=n(\"b775\");function a(t){return Object(o[\"a\"])({url:\"api/labels/add/\",method:\"POST\",data:t})}function i(){return Object(o[\"a\"])({url:\"api/labels/get/\"})}function s(t){return Object(o[\"a\"])({url:\"api/labels/update/\",method:\"POST\",data:t})}function r(t,e){return Object(o[\"a\"])({url:\"api/labels/updateColor/\",method:\"POST\",data:{id:t,color:e}})}function l(t){return Object(o[\"a\"])({url:\"api/labels/delete/\",method:\"POST\",data:{id:t}})}function c(t){return Object(o[\"a\"])({url:\"api/translate/?text=\".concat(t)})}},\"85e2\":function(t,e,n){},\"93f5\":function(t,e,n){},b270:function(t,e,n){\"use strict\";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",[n(\"TopNavigation\"),n(\"AnnotateContent\"),n(\"div\",{staticClass:\"footer\"},[t._v(\" Copyright © Syngou \")])],1)},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"topNavigation\"},[n(\"span\",{staticClass:\"title\"},[t._v(\"文本标注和处理系统\")]),n(\"a\",{on:{click:t.exportData}},[t._v(\"导出数据\")]),n(\"a\",{on:{click:t.saveTamporaryData}},[t._v(\"暂存数据\")]),t.avatar?n(\"div\",{staticClass:\"right-menu\"},[n(\"el-dropdown\",{staticClass:\"avatar-container\",attrs:{trigger:\"click\"}},[n(\"div\",{staticClass:\"avatar-wrapper\"},[n(\"img\",{staticClass:\"user-avatar\",attrs:{src:t.avatar,alt:\"用户头像\"}})]),n(\"el-dropdown-menu\",{staticClass:\"user-dropdown\",attrs:{slot:\"dropdown\"},slot:\"dropdown\"},[n(\"router-link\",{attrs:{to:\"/\"}},[n(\"el-dropdown-item\",[t._v(\" 主控台 \")])],1),n(\"router-link\",{attrs:{to:\"/labelsManage\"}},[n(\"el-dropdown-item\",[t._v(\" 标签管理 \")])],1),n(\"el-dropdown-item\",{attrs:{divided:\"\"},nativeOn:{click:function(e){return t.logout(e)}}},[n(\"span\",{staticStyle:{display:\"block\"}},[t._v(\"注销\")])])],1)],1)],1):n(\"router-link\",{staticStyle:{float:\"right\"},attrs:{to:\"/login\"}},[t._v(\" 登录 \")]),n(\"output-options\",{ref:\"outputOptions\"})],1)},s=[],r=n(\"1da1\"),l=n(\"5530\"),c=(n(\"96cf\"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",[n(\"el-dialog\",{attrs:{title:\"输出选项\",width:\"fit-content\",visible:t.dialogVisible,modal:!1},on:{\"update:visible\":function(e){t.dialogVisible=e}}},[n(\"el-form\",[n(\"el-form-item\",{attrs:{label:\"文件名\"}},[n(\"el-input\",{attrs:{placeholder:\"请输入文件名，默认为 output\"},model:{value:t.fileName,callback:function(e){t.fileName=e},expression:\"fileName\"}})],1),n(\"el-form-item\",{attrs:{label:\"后缀名\"}},[n(\"el-select\",{attrs:{placeholder:\"请选择\"},model:{value:t.fileFormat,callback:function(e){t.fileFormat=e},expression:\"fileFormat\"}},t._l(t.options,(function(t){return n(\"el-option\",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),n(\"div\",{staticClass:\"btn-group\"},[n(\"el-button\",{attrs:{type:\"primary\"},on:{click:t.outputFile}},[t._v(\" 确定 \")]),n(\"el-button\",{attrs:{type:\"danger\"},on:{click:function(e){t.dialogVisible=!1}}},[t._v(\" 取消 \")])],1)],1)],1)}),u=[],d=(n(\"d3b7\"),n(\"3ca3\"),n(\"ddb0\"),n(\"2b3d\"),n(\"9861\"),n(\"e9c4\"),n(\"99af\"),n(\"2f62\")),f={data:function(){return{dialogVisible:!1,options:[{value:\"jsonl\",label:\"jsonl\"},{value:\"json\",label:\"json\"},{value:\"txt\",label:\"txt\"}],fileName:\"output\",fileFormat:\"jsonl\"}},computed:Object(l[\"a\"])({},Object(d[\"b\"])([\"entityAnnotateData\"])),methods:{outputFile:function(){this.dialogVisible=!1;var t=window.URL.createObjectURL(new Blob([JSON.stringify({id:this.$store.state.annotate.essayId,text:this.$store.state.annotate.annotateText,annotations:this.entityAnnotateData})])),e=document.createElement(\"a\");e.href=t,e.setAttribute(\"download\",\"\".concat(this.fileName,\".\").concat(this.fileFormat)),document.body.appendChild(e),e.click()}}},p=f,g=(n(\"8110\"),n(\"2877\")),h=Object(g[\"a\"])(p,c,u,!1,null,\"dc15d72e\",null),v=h.exports,b={name:\"TopNavigation\",components:{OutputOptions:v},computed:Object(l[\"a\"])({},Object(d[\"b\"])([\"avatar\"])),methods:{logout:function(){var t=this;return Object(r[\"a\"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch(\"user/logout\");case 2:case\"end\":return e.stop()}}),e)})))()},exportData:function(){this.$refs.outputOptions.dialogVisible=!0},saveTamporaryData:function(){this.$message.info(\"待开发\")}}},m=b,w=(n(\"8083\"),Object(g[\"a\"])(m,i,s,!1,null,\"61021732\",null)),C=w.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{attrs:{id:\"paper\"}},[n(\"link\",{attrs:{rel:\"stylesheet\",href:\"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css\",integrity:\"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\",crossorigin:\"anonymous\"}}),n(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.showFunctionDialog,expression:\"showFunctionDialog\"}],ref:\"showFunctionDialog\",staticClass:\"optionDialog\"},[n(\"button\",{on:{click:t.chooseEntityAnnotate}},[t._v(\" 实体标注 \")]),n(\"button\",{on:{click:t.chooseRelationAnnotate}},[t._v(\" 关系标注 \")]),n(\"button\",{on:{click:t.chooseAttributeAnnotate}},[t._v(\" 属性标注 \")])]),n(\"div\",[n(\"ui-marker\",{ref:\"aiPanel-editor\",staticClass:\"ai-observer\",attrs:{uniqueKey:t.uuid,ratio:16/9,imgUrl:t.currentImage}})],1),n(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.showDialog,expression:\"showDialog\"}],ref:\"showDialog\",staticClass:\"optionDialog\"},[t._l(t.labels,(function(e,o){return n(\"button\",{key:o,style:{backgroundColor:e.color},on:{click:function(e){return t.annotateText(o+\"-\"+t.$store.state.annotate.id,o)}}},[t._v(\" \"+t._s(e.text)+\"(\"+t._s(e.shortcut)+\") \")])})),n(\"button\",{on:{click:t.translateText}},[t._v(\" 翻译 \")])],2),n(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.showTranslateCard,expression:\"showTranslateCard\"}],ref:\"translateCard\",staticClass:\"translate-card\"},[n(\"i\",{staticClass:\"el-message__closeBtn el-icon-close delete-button\",on:{click:function(e){t.showTranslateCard=!1}}}),n(\"TranslateCard\",{attrs:{data:t.translateResult}})],1),n(\"div\",{staticClass:\"container\"},[n(\"div\",{staticClass:\"row\"},[n(\"div\",{staticClass:\"col-md-2\"},[n(\"div\",{staticClass:\"panel panel-default\"},[t._m(0),n(\"div\",{staticClass:\"panel-body\"},[n(\"div\",{staticClass:\"side\"},[t._l(t.labels,(function(e,o){return n(\"button\",{key:o,style:{backgroundColor:e.color},on:{click:function(e){return t.annotateText(o+\"-\"+t.$store.state.annotate.id,o)}}},[t._v(\" \"+t._s(e.text)+\"(\"+t._s(e.shortcut)+\") \")])})),n(\"br\"),n(\"br\"),n(\"router-link\",{attrs:{to:\"/labelsManage\"}},[t._v(\" 添加新标签 \")])],2)])])]),n(\"div\",{staticClass:\"col-md-10\"},[n(\"div\",{staticClass:\"panel panel-default\"},[t._m(1),n(\"div\",{staticClass:\"panel-body\",attrs:{id:\"panel-body\"}},[n(\"pre\",{staticClass:\"annotate-content\",style:\"font-size:\"+t.$store.state.annotate.fontSize+\"px\",attrs:{id:\"annotateContent\"},domProps:{textContent:t._s(t.$store.state.annotate.annotateText)},on:{mouseup:function(e){return t.getSelection(e)}}})])])])])])])},x=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"panel-heading\"},[n(\"div\",{staticClass:\"head\"},[t._v(\" 现有标签 \")]),n(\"hr\"),n(\"div\",{staticClass:\"tip\"},[t._v(\" (选中文本后单击任一标签即可标注) \")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"panel-heading\"},[n(\"div\",{staticClass:\"head\"},[t._v(\" 文章如下 \")])])}],_=(n(\"25f0\"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{staticClass:\"card\"},[t._v(\" \"+t._s(t.data.result)+\" \")])}),k=[],S={name:\"TranslateCard\",props:{data:{type:Object,default:function(){return{}}}}},A=S,O=(n(\"063b\"),Object(g[\"a\"])(A,_,k,!1,null,\"01c33c9b\",null)),D=O.exports,T=n(\"2909\"),j=(n(\"ac1f\"),n(\"1276\"),n(\"498a\"),n(\"4360\"));function R(){return\"cursor:pointer;margin-left:5px\"}function $(t){return\"border:5px solid \".concat(j[\"a\"].state.annotate.labels[t].color,\";\\n          background-color:\").concat(j[\"a\"].state.annotate.labels[t].color,\";\\n          border-radius: 10px;\")}function E(t,e){var n=window.getSelection().toString(),o=\"border:5px solid #A3B9D9;\\n                            background-color:#A3B9D9;\\n                            border-radius: 10px;\";if(n.length>0){var a=document.querySelector(\"#annotateContent\"),i=window.getSelection().getRangeAt(0),s=i.cloneRange();s.selectNodeContents(a),s.setEnd(i.startContainer,i.startOffset);var r=document.createElement(\"span\");r.setAttribute(\"style\",o),e?r.setAttribute(\"id\",toString(t[1])+\"second\"):r.setAttribute(\"id\",toString(t[0])+\"first\");var l=window.getSelection().getRangeAt(0);l.surroundContents(r),window.getSelection().removeAllRanges()}}function F(t,e,n){var o,a,i=document.createElement(\"canvas\");console.log(t),console.log(e),o=t[0]<=e[0]?t[0]:e[0],a=t[1]<=e[1]?t[1]:e[1];var s=document.getElementById(toString(n[0])+\"first\");console.log(s),s.appendChild(i),i.style.position=\"relative\",i.style.zIndex=5,i.style.left=\"0px\",i.style.top=\"0px\",i.style.width=\"\".concat(e[0]+t[0]-2*o,\"px\"),i.style.height=\"\".concat(e[1]+t[1]-2*a+40,\"px\");var r=i.getContext(\"2d\");r.moveTo(10,100),r.lineTo(10,5),r.stroke(),r.moveTo(10,5),r.lineTo(e[0]+t[0]-2*o,5),r.stroke(),r.moveTo(e[0]+t[0]-2*o,5),r.lineTo(e[0]+t[0]-2*o,100),r.stroke()}function N(t,e){var n=window.getSelection().toString(),o=$(e);if(n.length>0){var a=document.querySelector(\"#annotateContent\"),i=window.getSelection().getRangeAt(0),s=i.cloneRange();s.selectNodeContents(a),s.setEnd(i.startContainer,i.startOffset);var r=Object(T[\"a\"])(s.toString()).length,l=r+Object(T[\"a\"])(i.toString()).length,c={id:t.split(\"-\")[1],label:t.split(\"-\")[0],start_offset:r,end_offset:l,text:n,user:1,updated_at:new Date};j[\"a\"].dispatch(\"annotate/addToList\",{id:t,entityAnnotateData:c});var u=document.createElement(\"i\");u.setAttribute(\"id\",t),u.addEventListener(\"click\",(function(){P(t)})),u.setAttribute(\"class\",\"el-icon-close\"),u.setAttribute(\"style\",R());var d=document.createElement(\"span\");d.setAttribute(\"style\",o);var f=window.getSelection().getRangeAt(0);f.surroundContents(d),d.appendChild(u),window.getSelection().removeAllRanges(),j[\"a\"].state.annotate.id++}}function P(t){var e=document.getElementById(\"annotateContent\"),n=document.getElementById(t).parentNode,o=document.createTextNode(n.innerText.trim()),a=n.innerText.trim();e.insertBefore(o,n),e.removeChild(n),j[\"a\"].dispatch(\"annotate/deleteDataFromList\",{type:t,text:a})}var B=n(\"84f5\"),I=n(\"a253\"),V={name:\"Essays\",components:{TranslateCard:D,\"ui-marker\":I[\"AIMarker\"]},data:function(){return{showFunctionDialog:!1,showDialog:!1,selectText:\"\",showTranslateCard:!1,translateResult:{},flag:!1,uuid:\"\",readOnly:!1,currentImage:\"uploads/warma.png\",position1:[[],[]],position2:[[],[]],id:[0,0]}},computed:Object(l[\"a\"])({},Object(d[\"b\"])([\"labels\"])),created:function(){this.annotateByShortcut()},methods:{setBoxPosition:function(t,e){this.$refs.showDialog.style.left=\"\".concat(t-100,\"px\"),this.$refs.showDialog.style.top=\"\".concat(e+20,\"px\"),this.$refs.showFunctionDialog.style.left=\"\".concat(t-100,\"px\"),this.$refs.showFunctionDialog.style.top=\"\".concat(e+20,\"px\"),this.$refs.translateCard.style.left=\"\".concat(t+10,\"px\"),this.$refs.translateCard.style.top=\"\".concat(e+10,\"px\")},getSelection:function(t){\"\"!==window.getSelection().toString()?this.flag?(this.position2[0]=window.getSelection().getRangeAt(0).getClientRects()[\"0\"].x,this.position2[1]=window.getSelection().getRangeAt(0).getClientRects()[\"0\"].y,E(this.id,1),this.id[1]++,F(this.position1,this.position2,this.id),this.flag=!1):(this.selectText=window.getSelection().toString(),this.setBoxPosition(t.pageX,t.pageY),this.showDialog=!1,this.showFunctionDialog=!0):(this.showDialog=!1,this.$refs.showDialog.style.display=\"none\",this.showFunctionDialog=!1)},chooseEntityAnnotate:function(){this.showFunctionDialog=!1,this.$refs.showDialog.style.display=\"block\",this.showDialog=!0},chooseRelationAnnotate:function(){this.showFunctionDialog=!1,this.position1[0]=window.getSelection().getRangeAt(0).getClientRects()[\"0\"].x,this.position1[1]=window.getSelection().getRangeAt(0).getClientRects()[\"0\"].y,E(this.id,0),this.id[0]++,this.flag=!0,console.log(this.flag)},chooseAttributeAnnotate:function(){},annotateText:function(t,e){this.showDialog=!1,N(t,e)},annotateByShortcut:function(){var t=this;document.onkeydown=function(e){var n=e.key,o=t.$store.state.annotate.id;t.showDialog=!1;for(var a=0;a<t.labels.length;a++)if(n===t.labels[a].shortcut){N(a+\"-\"+o,a);break}}},translateText:function(){var t=this;this.showDialog=!1;var e=window.getSelection().toString();Object(B[\"d\"])(e).then((function(e){t.translateResult=e.data,t.showTranslateCard=!0}))}}},L=V,z=(n(\"36ed\"),Object(g[\"a\"])(L,y,x,!1,null,\"8dfeef68\",null)),J=z.exports,U={name:\"Annotate\",components:{TopNavigation:C,AnnotateContent:J},mounted:function(){this.isPC()},methods:{isPC:function(){for(var t=[\"Android\",\"iPhone\",\"Windows Phone\",\"iPad\",\"iPod\"],e=navigator.userAgent,n=0;n<t.length;n++)if(e.indexOf(t[n])>0){this.$message.warning({message:\"手机是无法进行标注的哦,请使用电脑浏览器。\",duration:5e3,showClose:!0});break}}}},q=U,K=(n(\"b5fb\"),Object(g[\"a\"])(q,o,a,!1,null,\"260669d7\",null));e[\"default\"]=K.exports},b5fb:function(t,e,n){\"use strict\";n(\"21c1\")}}]);","extractedComments":[]}