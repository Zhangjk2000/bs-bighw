{"remainingRequest":"F:\\BS\\annotate-system-3\\frontend\\node_modules\\babel-loader\\lib\\index.js!F:\\BS\\annotate-system-3\\frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\BS\\annotate-system-3\\frontend\\src\\utils\\annotateUtils.js","dependencies":[{"path":"F:\\BS\\annotate-system-3\\frontend\\src\\utils\\annotateUtils.js","mtime":1639627257278},{"path":"F:\\BS\\annotate-system-3\\frontend\\babel.config.js","mtime":1639627257111},{"path":"F:\\BS\\annotate-system-3\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1639628022585},{"path":"F:\\BS\\annotate-system-3\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1639628024341},{"path":"F:\\BS\\annotate-system-3\\frontend\\node_modules\\eslint-loader\\index.js","mtime":1639628021347}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOlxcQlNcXGFubm90YXRlLXN5c3RlbS0zXFxmcm9udGVuZFxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgc3RvcmUgZnJvbSAiQC9zdG9yZS9pbmRleCI7IC8vaW1wb3J0IHsgc29tZSB9IGZyb20gImNvcmUtanMvY29yZS9hcnJheSI7CgovKioNCiAqICDmjInpkq7moLflvI8NCiAqLwoKZnVuY3Rpb24gYnV0dG9uU3R5bGUoKSB7CiAgcmV0dXJuICJjdXJzb3I6cG9pbnRlcjttYXJnaW4tbGVmdDo1cHgiOwp9Ci8qKg0KICoNCiAqICDov5Tlm57moIfms6jmlofmnKzmoLflvI8NCiAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCDmoIfms6jpopzoibLntKLlvJUNCiAqLwoKCmZ1bmN0aW9uIHRleHRTdHlsZShpbmRleCkgewogIHJldHVybiAiYm9yZGVyOjVweCBzb2xpZCAiLmNvbmNhdChzdG9yZS5zdGF0ZS5hbm5vdGF0ZS5sYWJlbHNbaW5kZXhdLmNvbG9yLCAiO1xuICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IikuY29uY2F0KHN0b3JlLnN0YXRlLmFubm90YXRlLmxhYmVsc1tpbmRleF0uY29sb3IsICI7XG4gICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsiKTsKfQovKioNCiAqDQogKiAg5YWz57O75qCH5rOoDQogKi8KCgpleHBvcnQgZnVuY3Rpb24gcmVsYXRpb25Bbm5vdGF0ZVV0aWwoaWQsIG9yZGVyKSB7CiAgdmFyIHRleHQgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKTsgLy8g5oyJ6ZKu5qC35byPCiAgLy8gVE9ET++8muagt+W8j+e+juWMlgogIC8vIOagh+azqOaWh+acrOagt+W8jwoKICB2YXIgYW5ub3RhdGVkVGVzdFN0eWxlID0gImJvcmRlcjo1cHggc29saWQgI0EzQjlEOTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiNBM0I5RDk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsiOyAvLyDpgInkuK3kuI3kuLrnqboKCiAgaWYgKHRleHQubGVuZ3RoID4gMCkgewogICAgLy8g6I635Y+W6LW35aeL57Si5byV5ZKM57uT5p2f57Si5byVCiAgICB2YXIgYW5ub3RhdGVDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2Fubm90YXRlQ29udGVudCIpOwogICAgdmFyIHJhbmdlID0gd2luZG93LmdldFNlbGVjdGlvbigpLmdldFJhbmdlQXQoMCk7CiAgICB2YXIgcHJlU2VsZWN0aW9uUmFuZ2UgPSByYW5nZS5jbG9uZVJhbmdlKCk7CiAgICBwcmVTZWxlY3Rpb25SYW5nZS5zZWxlY3ROb2RlQ29udGVudHMoYW5ub3RhdGVDb250ZW50KTsKICAgIHByZVNlbGVjdGlvblJhbmdlLnNldEVuZChyYW5nZS5zdGFydENvbnRhaW5lciwgcmFuZ2Uuc3RhcnRPZmZzZXQpOwogICAgdmFyIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7CiAgICBzcGFuLnNldEF0dHJpYnV0ZSgic3R5bGUiLCBhbm5vdGF0ZWRUZXN0U3R5bGUpOwogICAgaWYgKG9yZGVyKSBzcGFuLnNldEF0dHJpYnV0ZSgiaWQiLCB0b1N0cmluZyhpZFsxXSkgKyAic2Vjb25kIik7ZWxzZSBzcGFuLnNldEF0dHJpYnV0ZSgiaWQiLCB0b1N0cmluZyhpZFswXSkgKyAiZmlyc3QiKTsKICAgIHZhciBUZXh0UmFuZ2UgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZ2V0UmFuZ2VBdCgwKTsKICAgIFRleHRSYW5nZS5zdXJyb3VuZENvbnRlbnRzKHNwYW4pOyAvL3NwYW4uYXBwZW5kQ2hpbGQoYnV0dG9uKTsKICAgIC8v56e76Zmk6YCJ5Lit54q25oCB77yM5ZCm5YiZ5b6I6Zq+55yLCgogICAgd2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpOyAvL3N0b3JlLnN0YXRlLmFubm90YXRlLmlkKys7CiAgfQp9IC8vIOS4pOauteagh+azqOaWh+acrOS5i+mXtOi/nue6vwoKZXhwb3J0IGZ1bmN0aW9uIHJlbGF0aW9uTWF0Y2hpbmdVdGlsKHBvc2l0aW9uMSwgcG9zaXRpb24yLCBpZCkgewogIHZhciBkcmF3ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIik7CiAgY29uc29sZS5sb2cocG9zaXRpb24xKTsKICBjb25zb2xlLmxvZyhwb3NpdGlvbjIpOwogIHZhciBwb3NYbWluLCBwb3NZbWluOwogIGlmIChwb3NpdGlvbjFbMF0gPD0gcG9zaXRpb24yWzBdKSBwb3NYbWluID0gcG9zaXRpb24xWzBdO2Vsc2UgcG9zWG1pbiA9IHBvc2l0aW9uMlswXTsKICBpZiAocG9zaXRpb24xWzFdIDw9IHBvc2l0aW9uMlsxXSkgcG9zWW1pbiA9IHBvc2l0aW9uMVsxXTtlbHNlIHBvc1ltaW4gPSBwb3NpdGlvbjJbMV07CiAgdmFyIG5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0b1N0cmluZyhpZFswXSkgKyAiZmlyc3QiKTsKICBjb25zb2xlLmxvZyhub2RlKTsKICBub2RlLmFwcGVuZENoaWxkKGRyYXcpOwogIGRyYXcuc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwogIGRyYXcuc3R5bGUuekluZGV4ID0gNTsKICBkcmF3LnN0eWxlLmxlZnQgPSAiMHB4IjsKICBkcmF3LnN0eWxlLnRvcCA9ICIwcHgiOwogIGRyYXcuc3R5bGUud2lkdGggPSAiIi5jb25jYXQocG9zaXRpb24yWzBdICsgcG9zaXRpb24xWzBdIC0gMiAqIHBvc1htaW4sICJweCIpOwogIGRyYXcuc3R5bGUuaGVpZ2h0ID0gIiIuY29uY2F0KHBvc2l0aW9uMlsxXSArIHBvc2l0aW9uMVsxXSAtIDIgKiBwb3NZbWluICsgNDAsICJweCIpOwogIHZhciBvbmVMaW5lID0gZHJhdy5nZXRDb250ZXh0KCIyZCIpOyAvL2NvbnNvbGUubG9nKHBvc2l0aW9uMSk7CgogIG9uZUxpbmUubW92ZVRvKDEwLCAxMDApOwogIG9uZUxpbmUubGluZVRvKDEwLCA1KTsKICBvbmVMaW5lLnN0cm9rZSgpOwogIG9uZUxpbmUubW92ZVRvKDEwLCA1KTsKICBvbmVMaW5lLmxpbmVUbyhwb3NpdGlvbjJbMF0gKyBwb3NpdGlvbjFbMF0gLSAyICogcG9zWG1pbiwgNSk7CiAgb25lTGluZS5zdHJva2UoKTsKICBvbmVMaW5lLm1vdmVUbyhwb3NpdGlvbjJbMF0gKyBwb3NpdGlvbjFbMF0gLSAyICogcG9zWG1pbiwgNSk7CiAgb25lTGluZS5saW5lVG8ocG9zaXRpb24yWzBdICsgcG9zaXRpb24xWzBdIC0gMiAqIHBvc1htaW4sIDEwMCk7CiAgb25lTGluZS5zdHJva2UoKTsgLy9jb25zb2xlLmxvZygiaGhoaGgiKQp9Ci8qKg0KICoNCiAqICDlrp7kvZPmoIfms6gNCiAqIEBwYXJhbSB7c3RyaW5nfSBpZCDnu5lidXR0b27moIfnrb7nmoRpZO+8jOeUqOS6juWIoOmZpOaXtuafpeaJvg0KICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IOagh+azqOminOiJsue0ouW8lQ0KICovCgpleHBvcnQgZnVuY3Rpb24gZW50aXR5QW5ub3RhdGVVdGlsKGlkLCBpbmRleCkgewogIHZhciB0ZXh0ID0gd2luZG93LmdldFNlbGVjdGlvbigpLnRvU3RyaW5nKCk7IC8vIOaMiemSruagt+W8jwogIC8vIFRPRE/vvJrmoLflvI/nvo7ljJYKICAvLyDmoIfms6jmlofmnKzmoLflvI8KCiAgdmFyIGFubm90YXRlZFRlc3RTdHlsZSA9IHRleHRTdHlsZShpbmRleCk7IC8vIOmAieS4reS4jeS4uuepugoKICBpZiAodGV4dC5sZW5ndGggPiAwKSB7CiAgICAvLyDojrflj5botbflp4vntKLlvJXlkoznu5PmnZ/ntKLlvJUKICAgIHZhciBhbm5vdGF0ZUNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjYW5ub3RhdGVDb250ZW50Iik7CiAgICB2YXIgcmFuZ2UgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkuZ2V0UmFuZ2VBdCgwKTsKICAgIHZhciBwcmVTZWxlY3Rpb25SYW5nZSA9IHJhbmdlLmNsb25lUmFuZ2UoKTsKICAgIHByZVNlbGVjdGlvblJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyhhbm5vdGF0ZUNvbnRlbnQpOwogICAgcHJlU2VsZWN0aW9uUmFuZ2Uuc2V0RW5kKHJhbmdlLnN0YXJ0Q29udGFpbmVyLCByYW5nZS5zdGFydE9mZnNldCk7CgogICAgdmFyIHN0YXJ0ID0gX3RvQ29uc3VtYWJsZUFycmF5KHByZVNlbGVjdGlvblJhbmdlLnRvU3RyaW5nKCkpLmxlbmd0aDsKCiAgICB2YXIgZW5kID0gc3RhcnQgKyBfdG9Db25zdW1hYmxlQXJyYXkocmFuZ2UudG9TdHJpbmcoKSkubGVuZ3RoOwoKICAgIHZhciBlbnRpdHlBbm5vdGF0ZURhdGEgPSB7CiAgICAgIGlkOiBpZC5zcGxpdCgiLSIpWzFdLAogICAgICAvLyDnlKjkuo7liKDpmaTmn6Xmib4KICAgICAgbGFiZWw6IGlkLnNwbGl0KCItIilbMF0sCiAgICAgIC8vIOWIhuexuwogICAgICBzdGFydF9vZmZzZXQ6IHN0YXJ0LAogICAgICAvL+i1t+Wni+e0ouW8lQogICAgICBlbmRfb2Zmc2V0OiBlbmQsCiAgICAgIC8v57uT5p2f57Si5byVCiAgICAgIHRleHQ6IHRleHQsCiAgICAgIC8vIOS4u+imgeaYr+S4uuS6huWIoOmZpOagh+azqO+8jOWPr+S7peS9v+eUqOWFtuS7luWIoOmZpOaWueazlQogICAgICB1c2VyOiAxLAogICAgICAvLyBUT0RPIOaaguaXtuiuvuS4ujEKICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKQogICAgfTsKICAgIHN0b3JlLmRpc3BhdGNoKCJhbm5vdGF0ZS9hZGRUb0xpc3QiLCB7CiAgICAgIGlkOiBpZCwKICAgICAgZW50aXR5QW5ub3RhdGVEYXRhOiBlbnRpdHlBbm5vdGF0ZURhdGEKICAgIH0pOyAvLyDmjInpkq7mt7vliqDkuovku7YKCiAgICB2YXIgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaSIpOwogICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgiaWQiLCBpZCk7CiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbiAoKSB7CiAgICAgIGRlbGV0ZUJ5SWQoaWQpOwogICAgfSk7IC8vIOaMiemSruagt+W8jwoKICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImVsLWljb24tY2xvc2UiKTsKICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgYnV0dG9uU3R5bGUoKSk7CiAgICB2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsKICAgIHNwYW4uc2V0QXR0cmlidXRlKCJzdHlsZSIsIGFubm90YXRlZFRlc3RTdHlsZSk7CiAgICB2YXIgVGV4dFJhbmdlID0gd2luZG93LmdldFNlbGVjdGlvbigpLmdldFJhbmdlQXQoMCk7CiAgICBUZXh0UmFuZ2Uuc3Vycm91bmRDb250ZW50cyhzcGFuKTsKICAgIHNwYW4uYXBwZW5kQ2hpbGQoYnV0dG9uKTsgLy/np7vpmaTpgInkuK3nirbmgIHvvIzlkKbliJnlvojpmr7nnIsKCiAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7CiAgICBzdG9yZS5zdGF0ZS5hbm5vdGF0ZS5pZCsrOwogIH0KfQovKioNCiAqDQogKiAg5Yig6Zmk5qC35byPDQogKiBAcGFyYW0ge3N0cmluZ30gaWQgPT0+IOaMiemSrueahGlk77yM55So5LqO5p+l5om+DQogKi8KCmZ1bmN0aW9uIGRlbGV0ZUJ5SWQoaWQpIHsKICB2YXIgYW5ub3RhdGVDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImFubm90YXRlQ29udGVudCIpOwogIHZhciBzcGFuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLnBhcmVudE5vZGU7IC8vIOiOt+WPluaWh+acrO+8jOWwhuWFtuaPkuWFpeW9k+WJjeiKgueCueWJje+8jOWGjeWIoOmZpOiKgueCuQoKICB2YXIgdGV4dE5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzcGFuLmlubmVyVGV4dC50cmltKCkpOwogIHZhciB0ZXh0ID0gc3Bhbi5pbm5lclRleHQudHJpbSgpOwogIGFubm90YXRlQ29udGVudC5pbnNlcnRCZWZvcmUodGV4dE5vZGUsIHNwYW4pOwogIGFubm90YXRlQ29udGVudC5yZW1vdmVDaGlsZChzcGFuKTsKICBzdG9yZS5kaXNwYXRjaCgiYW5ub3RhdGUvZGVsZXRlRGF0YUZyb21MaXN0IiwgewogICAgdHlwZTogaWQsCiAgICB0ZXh0OiB0ZXh0CiAgfSk7Cn0KLyoqDQogKg0KICogIOacuuWZqOWtpuS5oOiHquWKqOWMluagh+azqA0KICogQHBhcmFtcyBkYXRhID09PiDlkI7lj7DkvKDmnaXnmoTmlbDmja7vvIzkuIDnu7TlrZfnrKbkuLLmlbDnu4QNCiAqLwovLyBUT0RPIOiOt+WPluavj+S4quWtl+eahOi1t+Wni+e0ouW8lQovLyBmdW5jdGlvbiBhdXRvQW5ub3RhdGUoZGF0YSkgewovLyAgIGxldCBhbm5vdGF0ZUNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYW5ub3RhdGVDb250ZW50Iik7Ci8vICAgbGV0IGFycmF5ID0gW107Ci8vICAgLy/miorlrZfnrKbkuLLliIblibIKLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsKLy8gICAgIGlmIChkYXRhW2ldKSB7Ci8vICAgICAgIGFycmF5LnB1c2goLi4uZGF0YVtpXS5zcGxpdCgiICIpKTsKLy8gICAgIH0KLy8gICAgIC8v5oqK5YiG5Ymy5Ye65p2l55qE5a2X56ym5Liy5YiG5Yir5qCH5rOoCi8vICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGFycmF5Lmxlbmd0aDsgaisrKSB7Ci8vICAgICAgIGlmIChhcnJheVtqXS5sZW5ndGggIT09IDApIHsKLy8gICAgICAgICBzdG9yZS5zdGF0ZS5hbm5vdGF0ZS5lbnRpdHlBbm5vdGF0ZURhdGFbaV0ucHVzaChhcnJheVtqXSk7Ci8vICAgICAgICAgYW5ub3RhdGVDb250ZW50LmlubmVySFRNTCA9IGFubm90YXRlQ29udGVudC5pbm5lckhUTUwucmVwbGFjZUFsbCgKLy8gICAgICAgICAgIGFycmF5W2pdLAovLyAgICAgICAgICAgYDxzcGFuIHN0eWxlPScke3RoaXMudGV4dFN0eWxlKGkpfSc+JHsKLy8gICAgICAgICAgICAgYXJyYXlbal0KLy8gICAgICAgICAgIH08aSBjbGFzcz0nZGVsZXRlQnV0dG9uVGVtcCBlbC1pY29uLWNsb3NlJyBzdHlsZT0nJHt0aGlzLmJ1dHRvblN0eWxlKCl9Jz48L2k+IDwvc3Bhbj5gCi8vICAgICAgICAgKTsKLy8gICAgICAgICBsZXQgYnV0dG9ucyA9IEFycmF5LmZyb20oCi8vICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJkZWxldGVCdXR0b25UZW1wIikKLy8gICAgICAgICApOwovLyAgICAgICAgIC8v5p+l5om+5oyJ6ZKu5bm25re75Yqg5Yig6Zmk5LqL5Lu277yM6L+Z56eN5pa55rOV5b6IbG9377yM5L2G5piv5pyJ5pWICi8vICAgICAgICAgLy/lpoLmnpzkvaDmnInmm7Tlpb3nmoTmg7Pms5XvvIzmrKLov47kv67mlLkKLy8gICAgICAgICAvL1RPRE/vvJrkvJjljJbku6PnoIEKLy8gICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IGJ1dHRvbnMubGVuZ3RoOyBrKyspIHsKLy8gICAgICAgICAgIGJ1dHRvbnNba10uaWQgPSBpICsgIi0iICsgc3RvcmUuc3RhdGUuYW5ub3RhdGUuaWQrKzsKLy8gICAgICAgICAgIGJ1dHRvbnNba10ub25jbGljayA9ICgpID0+IHsKLy8gICAgICAgICAgICAgdGhpcy5kZWxldGVCeUlkKGJ1dHRvbnNba10uaWQpOwovLyAgICAgICAgICAgfTsKLy8gICAgICAgICB9Ci8vICAgICAgIH0KLy8gICAgIH0KLy8gICAgIGFycmF5ID0gW107Ci8vICAgfQovLyB9LA=="},{"version":3,"sources":["F:/BS/annotate-system-3/frontend/src/utils/annotateUtils.js"],"names":["store","buttonStyle","textStyle","index","state","annotate","labels","color","relationAnnotateUtil","id","order","text","window","getSelection","toString","annotatedTestStyle","length","annotateContent","document","querySelector","range","getRangeAt","preSelectionRange","cloneRange","selectNodeContents","setEnd","startContainer","startOffset","span","createElement","setAttribute","TextRange","surroundContents","removeAllRanges","relationMatchingUtil","position1","position2","draw","console","log","posXmin","posYmin","node","getElementById","appendChild","style","position","zIndex","left","top","width","height","oneLine","getContext","moveTo","lineTo","stroke","entityAnnotateUtil","start","end","entityAnnotateData","split","label","start_offset","end_offset","user","updated_at","Date","dispatch","button","addEventListener","deleteById","parentNode","textNode","createTextNode","innerText","trim","insertBefore","removeChild","type"],"mappings":"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","sourcesContent":["import store from \"@/store/index\";\r\n//import { some } from \"core-js/core/array\";\r\n/**\r\n *  按钮样式\r\n */\r\nfunction buttonStyle() {\r\n  return \"cursor:pointer;margin-left:5px\";\r\n}\r\n/**\r\n *\r\n *  返回标注文本样式\r\n * @param {number} index 标注颜色索引\r\n */\r\nfunction textStyle(index) {\r\n  return `border:5px solid ${store.state.annotate.labels[index].color};\r\n          background-color:${store.state.annotate.labels[index].color};\r\n          border-radius: 10px;`;\r\n}\r\n\r\n/**\r\n *\r\n *  关系标注\r\n */\r\nexport function relationAnnotateUtil(id, order) {\r\n  let text = window.getSelection().toString();\r\n\r\n  // 按钮样式\r\n  // TODO：样式美化\r\n  // 标注文本样式\r\n  let annotatedTestStyle = `border:5px solid #A3B9D9;\r\n                            background-color:#A3B9D9;\r\n                            border-radius: 10px;`;\r\n  // 选中不为空\r\n  if (text.length > 0) {\r\n    // 获取起始索引和结束索引\r\n    let annotateContent = document.querySelector(\"#annotateContent\");\r\n    const range = window.getSelection().getRangeAt(0);\r\n    const preSelectionRange = range.cloneRange();\r\n    preSelectionRange.selectNodeContents(annotateContent);\r\n    preSelectionRange.setEnd(range.startContainer, range.startOffset);\r\n\r\n    let span = document.createElement(\"span\");\r\n    span.setAttribute(\"style\", annotatedTestStyle);\r\n    if (order) span.setAttribute(\"id\", toString(id[1]) + \"second\");\r\n    else span.setAttribute(\"id\", toString(id[0]) + \"first\");\r\n\r\n    let TextRange = window.getSelection().getRangeAt(0);\r\n    TextRange.surroundContents(span);\r\n    //span.appendChild(button);\r\n    //移除选中状态，否则很难看\r\n    window.getSelection().removeAllRanges();\r\n    //store.state.annotate.id++;\r\n  }\r\n}\r\n// 两段标注文本之间连线\r\nexport function relationMatchingUtil(position1, position2, id) {\r\n  let draw = document.createElement(\"canvas\");\r\n  console.log(position1);\r\n  console.log(position2);\r\n  let posXmin, posYmin;\r\n  if (position1[0] <= position2[0]) posXmin = position1[0];\r\n  else posXmin = position2[0];\r\n  if (position1[1] <= position2[1]) posYmin = position1[1];\r\n  else posYmin = position2[1];\r\n\r\n  let node = document.getElementById(toString(id[0]) + \"first\");\r\n  console.log(node);\r\n  node.appendChild(draw);\r\n  draw.style.position = \"relative\";\r\n  draw.style.zIndex = 5;\r\n  draw.style.left = `0px`;\r\n  draw.style.top = `0px`;\r\n  draw.style.width = `${position2[0] + position1[0] - 2 * posXmin}px`;\r\n  draw.style.height = `${position2[1] + position1[1] - 2 * posYmin + 40}px`;\r\n  let oneLine = draw.getContext(\"2d\");\r\n  //console.log(position1);\r\n  oneLine.moveTo(10, 100);\r\n  oneLine.lineTo(10, 5);\r\n  oneLine.stroke();\r\n  oneLine.moveTo(10, 5);\r\n  oneLine.lineTo(position2[0] + position1[0] - 2 * posXmin, 5);\r\n  oneLine.stroke();\r\n  oneLine.moveTo(position2[0] + position1[0] - 2 * posXmin, 5);\r\n  oneLine.lineTo(position2[0] + position1[0] - 2 * posXmin, 100);\r\n  oneLine.stroke();\r\n\r\n  //console.log(\"hhhhh\")\r\n}\r\n/**\r\n *\r\n *  实体标注\r\n * @param {string} id 给button标签的id，用于删除时查找\r\n * @param {number} index 标注颜色索引\r\n */\r\nexport function entityAnnotateUtil(id, index) {\r\n  let text = window.getSelection().toString();\r\n\r\n  // 按钮样式\r\n  // TODO：样式美化\r\n  // 标注文本样式\r\n  let annotatedTestStyle = textStyle(index);\r\n  // 选中不为空\r\n  if (text.length > 0) {\r\n    // 获取起始索引和结束索引\r\n    let annotateContent = document.querySelector(\"#annotateContent\");\r\n    const range = window.getSelection().getRangeAt(0);\r\n    const preSelectionRange = range.cloneRange();\r\n    preSelectionRange.selectNodeContents(annotateContent);\r\n    preSelectionRange.setEnd(range.startContainer, range.startOffset);\r\n    let start = [...preSelectionRange.toString()].length;\r\n    let end = start + [...range.toString()].length;\r\n\r\n    let entityAnnotateData = {\r\n      id: id.split(\"-\")[1], // 用于删除查找\r\n      label: id.split(\"-\")[0], // 分类\r\n      start_offset: start, //起始索引\r\n      end_offset: end, //结束索引\r\n      text: text, // 主要是为了删除标注，可以使用其他删除方法\r\n      user: 1, // TODO 暂时设为1\r\n      updated_at: new Date(),\r\n    };\r\n\r\n    store.dispatch(\"annotate/addToList\", { id, entityAnnotateData });\r\n    // 按钮添加事件\r\n    let button = document.createElement(\"i\");\r\n    button.setAttribute(\"id\", id);\r\n    button.addEventListener(\"click\", () => {\r\n      deleteById(id);\r\n    });\r\n    // 按钮样式\r\n    button.setAttribute(\"class\", \"el-icon-close\");\r\n    button.setAttribute(\"style\", buttonStyle());\r\n    let span = document.createElement(\"span\");\r\n    span.setAttribute(\"style\", annotatedTestStyle);\r\n\r\n    let TextRange = window.getSelection().getRangeAt(0);\r\n    TextRange.surroundContents(span);\r\n    span.appendChild(button);\r\n    //移除选中状态，否则很难看\r\n    window.getSelection().removeAllRanges();\r\n    store.state.annotate.id++;\r\n  }\r\n}\r\n\r\n/**\r\n *\r\n *  删除样式\r\n * @param {string} id ==> 按钮的id，用于查找\r\n */\r\nfunction deleteById(id) {\r\n  let annotateContent = document.getElementById(\"annotateContent\");\r\n  let span = document.getElementById(id).parentNode;\r\n  // 获取文本，将其插入当前节点前，再删除节点\r\n  let textNode = document.createTextNode(span.innerText.trim());\r\n  let text = span.innerText.trim();\r\n  annotateContent.insertBefore(textNode, span);\r\n  annotateContent.removeChild(span);\r\n  store.dispatch(\"annotate/deleteDataFromList\", { type: id, text });\r\n}\r\n\r\n/**\r\n *\r\n *  机器学习自动化标注\r\n * @params data ==> 后台传来的数据，一维字符串数组\r\n */\r\n// TODO 获取每个字的起始索引\r\n// function autoAnnotate(data) {\r\n//   let annotateContent = document.getElementById(\"annotateContent\");\r\n//   let array = [];\r\n//   //把字符串分割\r\n//   for (let i = 0; i < data.length; i++) {\r\n//     if (data[i]) {\r\n//       array.push(...data[i].split(\" \"));\r\n//     }\r\n//     //把分割出来的字符串分别标注\r\n//     for (let j = 0; j < array.length; j++) {\r\n//       if (array[j].length !== 0) {\r\n//         store.state.annotate.entityAnnotateData[i].push(array[j]);\r\n//         annotateContent.innerHTML = annotateContent.innerHTML.replaceAll(\r\n//           array[j],\r\n//           `<span style='${this.textStyle(i)}'>${\r\n//             array[j]\r\n//           }<i class='deleteButtonTemp el-icon-close' style='${this.buttonStyle()}'></i> </span>`\r\n//         );\r\n\r\n//         let buttons = Array.from(\r\n//           document.getElementsByClassName(\"deleteButtonTemp\")\r\n//         );\r\n//         //查找按钮并添加删除事件，这种方法很low，但是有效\r\n//         //如果你有更好的想法，欢迎修改\r\n//         //TODO：优化代码\r\n//         for (let k = 0; k < buttons.length; k++) {\r\n//           buttons[k].id = i + \"-\" + store.state.annotate.id++;\r\n//           buttons[k].onclick = () => {\r\n//             this.deleteById(buttons[k].id);\r\n//           };\r\n//         }\r\n//       }\r\n//     }\r\n//     array = [];\r\n//   }\r\n// },\r\n"]}]}